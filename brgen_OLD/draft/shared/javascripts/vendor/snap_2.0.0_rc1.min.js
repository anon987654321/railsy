(function(n,h){var b={extend:function(e,d){for(var c in d)d[c]&&d[c].constructor&&d[c].constructor===Object?(e[c]=e[c]||{},b.extend(e[c],d[c])):e[c]=d[c];return e}},m=function(e){var d=this,c=d.settings={element:null,dragger:null,disable:"none",addBodyClasses:!0,hyperextensible:!0,resistance:.5,flickThreshold:50,transitionSpeed:.3,easing:"ease",maxPosition:266,minPosition:-266,tapToClose:!0,touchToDrag:!0,clickToDrag:!0,slideIntent:40,minDragDistance:5},a=d.cache={isDragging:!1,simpleStates:{opening:null,
towards:null,hyperExtending:null,halfway:null,flick:null,translation:{absolute:0,relative:0,sinceDirectionChange:0,percentage:0}}},m=d.eventList={};b.extend(b,{hasTouch:"ontouchstart"in h.documentElement||n.navigator.msPointerEnabled,eventType:function(a){return{down:b.hasTouch?"touchstart":c.clickToDrag?"mousedown":"",move:b.hasTouch?"touchmove":c.clickToDrag?"mousemove":"",up:b.hasTouch?"touchend":c.clickToDrag?"mouseup":"",out:b.hasTouch?"touchcancel":c.clickToDrag?"mouseout":""}[a]},page:function(a,
c){return b.hasTouch&&c.touches.length&&c.touches[0]?c.touches[0]["page"+a]:c["page"+a]},klass:{has:function(a,c){return-1!==a.className.indexOf(c)},add:function(a,f){!b.klass.has(a,f)&&c.addBodyClasses&&(a.className+=" "+f)},remove:function(a,f){b.klass.has(a,f)&&c.addBodyClasses&&(a.className=a.className.replace(f,"").replace(/^\s+|\s+$/g,""))}},dispatchEvent:function(a){if("function"===typeof m[a])return m[a].apply()},vendor:function(){var a=h.createElement("div"),c=["webkit","Moz","O","ms"],b;
for(b in c)if("undefined"!==typeof a.style[c[b]+"Transition"])return c[b]},transitionCallback:function(){return"Moz"===a.vendor||"ms"===a.vendor?"transitionend":a.vendor+"TransitionEnd"},canTransform:function(){return"undefined"!==typeof c.element.style[a.vendor+"Transform"]},angleOfDrag:function(c,b){var l;l=Math.atan2(-(a.startDragY-b),a.startDragX-c);0>l&&(l+=2*Math.PI);l=Math.floor(180/Math.PI*l-180);0>l&&-180<l&&(l=360-Math.abs(l));return Math.abs(l)},events:{addEvent:function(a,c,b){if(a.addEventListener)return a.addEventListener(c,
b,!1);if(a.attachEvent)return a.attachEvent("on"+c,b)},removeEvent:function(a,c,b){if(a.addEventListener)return a.removeEventListener(c,b,!1);if(a.attachEvent)return a.detachEvent("on"+c,b)},prevent:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1}},parentUntil:function(a,c){for(var b="string"===typeof c;a.parentNode;){if(b&&a.getAttribute&&a.getAttribute(c)||!b&&a===c)return a;a=a.parentNode}return null}});var g=d.action={translate:{get:{matrix:function(b){if(a.canTransform){var f=
n.getComputedStyle(c.element)[a.vendor+"Transform"].match(/\((.*)\)/);return f?(f=f[1].split(","),16===f.length&&(b+=8),parseInt(f[b],10)):0}return parseInt(c.element.style.left,10)}},easeCallback:function(p){c.element.style[a.vendor+"Transition"]="";a.translation=g.translate.get.matrix(4);a.easing=!1;0===a.easingTo&&(b.klass.remove(h.body,"snapjs-right"),b.klass.remove(h.body,"snapjs-left"));a.once&&(a.once.call(d,d.state()),delete a.once);b.dispatchEvent("animated");b.events.removeEvent(c.element,
b.transitionCallback(),g.translate.easeCallback)},easeTo:function(p,f){a.canTransform?(a.easing=!0,a.easingTo=p,c.element.style[a.vendor+"Transition"]="all "+c.transitionSpeed+"s "+c.easing,a.once=f,b.events.addEvent(c.element,b.transitionCallback(),g.translate.easeCallback)):a.translation=p;g.translate.x(p);0===p&&(c.element.style[a.vendor+"Transform"]="")},x:function(b){if(!("left"===c.disable&&0<b||"right"===c.disable&&0>b)){if(!c.hyperextensible)if(b===c.maxPosition||b>c.maxPosition)b=c.maxPosition;
else if(b===c.minPosition||b<c.minPosition)b=c.minPosition;b=parseInt(b,10);isNaN(b)&&(b=0);a.canTransform?c.element.style[a.vendor+"Transform"]="translate3d("+b+"px, 0,0)":(c.element.style.width=(n.innerWidth||h.documentElement.clientWidth)+"px",c.element.style.left=b+"px",c.element.style.right="")}}},drag:{listen:function(){a.translation=0;a.easing=!1;b.events.addEvent(d.settings.element,b.eventType("down"),g.drag.startDrag);b.events.addEvent(d.settings.element,b.eventType("move"),g.drag.dragging);
b.events.addEvent(d.settings.element,b.eventType("up"),g.drag.endDrag)},stopListening:function(){b.events.removeEvent(c.element,b.eventType("down"),g.drag.startDrag);b.events.removeEvent(c.element,b.eventType("move"),g.drag.dragging);b.events.removeEvent(c.element,b.eventType("up"),g.drag.endDrag)},startDrag:function(e){var f=e.target?e.target:e.srcElement;if(b.parentUntil(f,"data-snap-ignore"))b.dispatchEvent("ignore");else if(!c.dragger||b.parentUntil(f,c.dragger)||a.translation===c.minPosition||
a.translation===c.maxPosition)b.dispatchEvent("start"),c.element.style[a.vendor+"Transition"]="",a.isDragging=!0,a.intentChecked=!1,a.startDragX=b.page("X",e),a.startDragY=b.page("Y",e),a.dragWatchers={current:0,last:0,hold:0,state:""},a.simpleStates={opening:null,towards:null,hyperExtending:null,halfway:null,flick:null,translation:{absolute:0,relative:0,sinceDirectionChange:0,percentage:0}}},dragging:function(e){if(a.isDragging&&c.touchToDrag){var f=b.page("X",e),d=b.page("Y",e),m=a.translation,
k=g.translate.get.matrix(4),q=f-a.startDragX,n=0<k,r=q;if(!a.intentChecked||a.hasIntent){c.addBodyClasses&&(0<k?(b.klass.add(h.body,"snapjs-left"),b.klass.remove(h.body,"snapjs-right")):0>k&&(b.klass.add(h.body,"snapjs-right"),b.klass.remove(h.body,"snapjs-left")));if(!1===a.hasIntent||null===a.hasIntent){var d=b.angleOfDrag(f,d),s=0<=d&&d<=c.slideIntent||360>=d&&d>360-c.slideIntent;a.hasIntent=180<=d&&d<=180+c.slideIntent||180>=d&&d>=180-c.slideIntent||s?!0:!1;a.intentChecked=!0}c.minDragDistance>=
Math.abs(f-a.startDragX)||!1===a.hasIntent||(b.events.prevent(e),b.dispatchEvent("drag"),a.dragWatchers.current=f,a.dragWatchers.last>f?("left"!==a.dragWatchers.state&&(a.dragWatchers.state="left",a.dragWatchers.hold=f),a.dragWatchers.last=f):a.dragWatchers.last<f&&("right"!==a.dragWatchers.state&&(a.dragWatchers.state="right",a.dragWatchers.hold=f),a.dragWatchers.last=f),n?(c.maxPosition<k&&(e=(k-c.maxPosition)*c.resistance,r=q-e),a.simpleStates={opening:"left",towards:a.dragWatchers.state,hyperExtending:c.maxPosition<
k,halfway:k>c.maxPosition/2,flick:Math.abs(a.dragWatchers.current-a.dragWatchers.hold)>c.flickThreshold,translation:{absolute:k,relative:q,sinceDirectionChange:a.dragWatchers.current-a.dragWatchers.hold,percentage:k/c.maxPosition*100}}):(c.minPosition>k&&(e=(k-c.minPosition)*c.resistance,r=q-e),a.simpleStates={opening:"right",towards:a.dragWatchers.state,hyperExtending:c.minPosition>k,halfway:k<c.minPosition/2,flick:Math.abs(a.dragWatchers.current-a.dragWatchers.hold)>c.flickThreshold,translation:{absolute:k,
relative:q,sinceDirectionChange:a.dragWatchers.current-a.dragWatchers.hold,percentage:k/c.minPosition*100}}),g.translate.x(r+m))}}},endDrag:function(e){if(a.isDragging){b.dispatchEvent("end");var d=g.translate.get.matrix(4);0===a.dragWatchers.current&&0!==d&&c.tapToClose?(b.dispatchEvent("close"),b.events.prevent(e),g.translate.easeTo(0),a.isDragging=!1,a.startDragX=0):("left"===a.simpleStates.opening?a.simpleStates.halfway||a.simpleStates.hyperExtending||a.simpleStates.flick?a.simpleStates.flick&&
"left"===a.simpleStates.towards?g.translate.easeTo(0):(a.simpleStates.flick&&"right"===a.simpleStates.towards||a.simpleStates.halfway||a.simpleStates.hyperExtending)&&g.translate.easeTo(c.maxPosition):g.translate.easeTo(0):"right"===a.simpleStates.opening&&(a.simpleStates.halfway||a.simpleStates.hyperExtending||a.simpleStates.flick?a.simpleStates.flick&&"right"===a.simpleStates.towards?g.translate.easeTo(0):(a.simpleStates.flick&&"left"===a.simpleStates.towards||a.simpleStates.halfway||a.simpleStates.hyperExtending)&&
g.translate.easeTo(c.minPosition):g.translate.easeTo(0)),a.isDragging=!1,a.startDragX=b.page("X",e))}}}};e.element&&(b.extend(c,e),a.vendor=b.vendor(),a.canTransform=b.canTransform(),g.drag.listen())};b.extend(m.prototype,{open:function(e,d){b.dispatchEvent("open");b.klass.remove(h.body,"snapjs-expand-left");b.klass.remove(h.body,"snapjs-expand-right");"left"===e?(this.cache.simpleStates.opening="left",this.cache.simpleStates.towards="right",b.klass.add(h.body,"snapjs-left"),b.klass.remove(h.body,
"snapjs-right"),this.action.translate.easeTo(this.settings.maxPosition,d)):"right"===e&&(this.cache.simpleStates.opening="right",this.cache.simpleStates.towards="left",b.klass.remove(h.body,"snapjs-left"),b.klass.add(h.body,"snapjs-right"),this.action.translate.easeTo(this.settings.minPosition,d))},close:function(e){b.dispatchEvent("close");this.action.translate.easeTo(0,e)},expand:function(e){var d=n.innerWidth||h.documentElement.clientWidth;"left"===e?(b.dispatchEvent("expandLeft"),b.klass.add(h.body,
"snapjs-expand-left"),b.klass.remove(h.body,"snapjs-expand-right")):(b.dispatchEvent("expandRight"),b.klass.add(h.body,"snapjs-expand-right"),b.klass.remove(h.body,"snapjs-expand-left"),d*=-1);this.action.translate.easeTo(d)},on:function(b,d){this.eventList[b]=d;return this},off:function(b){this.eventList[b]&&(this.eventList[b]=!1)},enable:function(){b.dispatchEvent("enable");this.action.drag.listen()},disable:function(){b.dispatchEvent("disable");this.action.drag.stopListening()},settings:function(e){b.extend(this.settings,
e)},state:function(){var b=this.action.translate.get.matrix(4);return{state:b===this.settings.maxPosition?"left":b===this.settings.minPosition?"right":"closed",info:this.cache.simpleStates}}});this.Snap=m}).call(this,window,document);

